<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>A few hours of running a honeypot | khalid.se</title>
<meta name=keywords content="cybersecurity"><meta name=description content="I often come across various communities that strongly encourage people to self-host for a variety of reasons: in the interest of data sovereignty, to break free from big tech, or simply because it&rsquo;s &ldquo;FUN&rdquo;. However, I believe that many of these encouragements do not take into account the risks associated with running your infrastructure, nor do they take into account the competence required to correctly configure specific products, systems, applications so that they can provide a secure solution."><meta name=author content><link rel=canonical href=https://khalid.se/posts/2023-09-06_honeypot/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://khalid.se/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://khalid.se/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://khalid.se/favicon-32x32.png><link rel=apple-touch-icon href=https://khalid.se/apple-touch-icon.png><link rel=mask-icon href=https://khalid.se/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="A few hours of running a honeypot"><meta property="og:description" content="I often come across various communities that strongly encourage people to self-host for a variety of reasons: in the interest of data sovereignty, to break free from big tech, or simply because it&rsquo;s &ldquo;FUN&rdquo;. However, I believe that many of these encouragements do not take into account the risks associated with running your infrastructure, nor do they take into account the competence required to correctly configure specific products, systems, applications so that they can provide a secure solution."><meta property="og:type" content="article"><meta property="og:url" content="https://khalid.se/posts/2023-09-06_honeypot/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-07T00:00:00+02:00"><meta property="article:modified_time" content="2023-09-07T00:00:00+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="A few hours of running a honeypot"><meta name=twitter:description content="I often come across various communities that strongly encourage people to self-host for a variety of reasons: in the interest of data sovereignty, to break free from big tech, or simply because it&rsquo;s &ldquo;FUN&rdquo;. However, I believe that many of these encouragements do not take into account the risks associated with running your infrastructure, nor do they take into account the competence required to correctly configure specific products, systems, applications so that they can provide a secure solution."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://khalid.se/posts/"},{"@type":"ListItem","position":2,"name":"A few hours of running a honeypot","item":"https://khalid.se/posts/2023-09-06_honeypot/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"A few hours of running a honeypot","name":"A few hours of running a honeypot","description":"I often come across various communities that strongly encourage people to self-host for a variety of reasons: in the interest of data sovereignty, to break free from big tech, or simply because it\u0026rsquo;s \u0026ldquo;FUN\u0026rdquo;. However, I believe that many of these encouragements do not take into account the risks associated with running your infrastructure, nor do they take into account the competence required to correctly configure specific products, systems, applications so that they can provide a secure solution.","keywords":["cybersecurity"],"articleBody":"I often come across various communities that strongly encourage people to self-host for a variety of reasons: in the interest of data sovereignty, to break free from big tech, or simply because it’s “FUN”. However, I believe that many of these encouragements do not take into account the risks associated with running your infrastructure, nor do they take into account the competence required to correctly configure specific products, systems, applications so that they can provide a secure solution. And if you can’t accomplish this (or if you run outdated, vulnerable software), you might end up with an entry point in your setup, allowing an outsider to gain access to your server. Moreover, without the ability to respond promptly 24/7, you may not be able to react in a timely manner — assuming you’ve even set up some kind of intrusion detection.\nAs an experiment, I spun up a server and redirected the SSH daemon on the host away from the default port 22. In its place, I deployed an SSH honeypot called sshesame and let it run for a few hours. I configured it to accept any combination of usernames and passwords, allowing me to monitor the commands being sent.\nThe results provide valuable insights into the modus operandi of these threat actors. The initial actions seem always to be to ascertain what they have gained access to by looking at the current running kernel, what CPU/GPU is present, geographic location of the server, and if the server has GSM capabilities. One interesting aspect is that a search for a [Mm]iner process was made, which would indicate that the machine is vulnerable and has the potential to be exploited.\nFunny enough, they always seem to ignore the MOTD banner saying in capital letters “THIS IS A SSH HONEYPOT. EVERYTHING WILL BE LOGGED AND MONITORED” :-)\nI would like to take this a step further and provide a useful response back when the probing commands are issued; my current setup simply responds command not found to each command invoked, and a response closer to a real-world scenario would yield more interesting results. However, my gut feeling is that these probes are only after bitcoin mining candidates, considering that the threat actors’ initial commands are probing for the hardware capacity of the machine and if other miners are present.\nYou can access the full raw log here to get an idea of how threat actors operate (or just see what credentials they use to log in).\nIf you’re interested in setting up your honeypot, it’s as simple as running the following Docker command:\nsudo docker run -it --rm -p 22:2022 ghcr.io/jaksi/sshesame Do note that the antagonists in this example are not particularly sophisticated; a persistent threat actor might act in a similar way during the initial foothold, but would probably act very differently shortly thereafter (or probably stop at the warning sign that they are entering a honeypot).\nYou can find more honeypots on this awesome list and read up more in depth about running a custom honeypot on the honeynetwork\n","wordCount":"509","inLanguage":"en","datePublished":"2023-09-07T00:00:00+02:00","dateModified":"2023-09-07T00:00:00+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://khalid.se/posts/2023-09-06_honeypot/"},"publisher":{"@type":"Organization","name":"khalid.se","logo":{"@type":"ImageObject","url":"https://khalid.se/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://khalid.se accesskey=h title="khalid.se (Alt + H)">khalid.se</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://khalid.se/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://khalid.se/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://khalid.se/about/ title="About me"><span>About me</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">A few hours of running a honeypot</h1><div class=post-meta><span title='2023-09-07 00:00:00 +0200 CEST'>September 7, 2023</span></div></header><div class=post-content><p>I often come across various communities that strongly encourage people to self-host for a variety of reasons: in the interest of data sovereignty, to break free from big tech, or simply because it&rsquo;s <a href="https://dwarffortresswiki.org/DF2014:Fun&amp;redirect=no">&ldquo;FUN&rdquo;</a>. However, I believe that many of these encouragements do not take into account the risks associated with running your infrastructure, nor do they take into account the competence required to correctly configure specific products, systems, applications so that they can provide a secure solution. And if you can&rsquo;t accomplish this (or if you run outdated, vulnerable software), you might end up with an entry point in your setup, allowing an outsider to gain access to your server. Moreover, without the ability to respond promptly 24/7, you may not be able to react in a timely manner — assuming you&rsquo;ve even set up some kind of intrusion detection.</p><p>As an experiment, I spun up a server and redirected the SSH daemon on the host away from the default port 22. In its place, I deployed an SSH honeypot called <a href=https://github.com/jaksi/sshesame>sshesame</a> and let it run for a few hours. I configured it to accept any combination of usernames and passwords, allowing me to monitor the commands being sent.</p><p>The results provide valuable insights into the modus operandi of these threat actors. The initial actions seem always to be to ascertain what they have gained access to by looking at the current running kernel, what CPU/GPU is present, geographic location of the server, and if the server has GSM capabilities. One interesting aspect is that a search for a <code>[Mm]iner</code> process was made, which would indicate that the machine is vulnerable and has the potential to be exploited.</p><p>Funny enough, they always seem to ignore the MOTD banner saying in capital letters &ldquo;THIS IS A SSH HONEYPOT. EVERYTHING WILL BE LOGGED AND MONITORED&rdquo; :-)</p><p>I would like to take this a step further and provide a useful response back when the probing commands are issued; my current setup simply responds <code>command not found</code> to each command invoked, and a response closer to a real-world scenario would yield more interesting results. However, my gut feeling is that these probes are only after bitcoin mining candidates, considering that the threat actors&rsquo; initial commands are probing for the hardware capacity of the machine and if other miners are present.</p><p>You can access the full raw log <a href=../2023-09-04_honeypot.log>here</a> to get an idea of how threat actors operate (or just see what credentials they use to log in).</p><p>If you&rsquo;re interested in setting up your honeypot, it&rsquo;s as simple as running the following Docker command:</p><pre tabindex=0><code>sudo docker run -it --rm -p 22:2022 ghcr.io/jaksi/sshesame
</code></pre><p>Do note that the antagonists in this example are not particularly sophisticated; a persistent threat actor might act in a similar way during the initial foothold, but would probably act very differently shortly thereafter (or probably stop at the warning sign that they are entering a honeypot).</p><p><em>You can find more honeypots on <a href=https://github.com/paralax/awesome-honeypots>this awesome list</a> and read up more in depth about running a custom honeypot on the <a href=https://communityhoneynetwork.readthedocs.io/en/stable/firstpot/>honeynetwork</a></em></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://khalid.se/tags/cybersecurity/>cybersecurity</a></li></ul></footer></article></main><footer class=footer><section class=container><p><a href="https://fediring.net/previous?host=khalid.se">←</a>
<a href=https://fediring.net/>Fediring</a>
<a href="https://fediring.net/next?host=khalid.se">→</a></p></section></footer></body></html>